## Introduction

#### What is an External Pentest?
Trying to hack into an organization from outside of that organization's network. 

#### Checklists
Checkout the excel file. https://github.com/tanprathan/OWASP-Testing-Checklist/blob/master/OWASP_WSTG_Checklist.xlsx

#### Rules of Engagement
Make sure you read whole document, specially in scope and out of scope part. 


## Kicking off

#### Attack Strategy
1. Think of external pentests like home security. 
2. Low chance of RCE, high chance of weak passwords. 

#### Vulnerability Scanning
1. Bugcrowd
2. Nessus

#### Reviewing and Extracting Information
1. Check critical ones 
2. Check out the exploits 

## Information Gathering / OSINT

#### Hunting Breached Credentials
1. Breach-parse
2. Dehashed 

#### Identifying Employees and Emails
1. Phonebook.cz
2. LinkedIn

#### Enumerating Valid Accounts (Pre-Attack)
Check fake email and random password on website login page, it will show some message like 'wrong email address or right email account but wrong password' which will verify account existence. 

#### Other Useful information. 
Finding password policy make it easy for password attacks. 

## Attacking Login Portals

#### Attacking Office 365
1. Password Spraying Tool: https://github.com/blacklanternsecurity/TREVORspray
2. Check out the Lock out policy. 
3. Once login with an account, you get access to all other Office 365 suite file access like word, excel, SharePoint etc. 

#### Attacking OWA (Outlook Web App)
1. Use Metasploit OWA module 

#### Attacking Other Portals
1. Use Brupsuite for other portals. 

#### Bypassing MFA
1. Use MFASweep tool: https://github.com/dafthack/MFASweep

## Escalating Access
1. Once you login office 365 account, you can search multiple valid username other there. 

## Report Writing
https://github.com/hmaverickadams/TCM-Security-Sample-Pentest-Report/blob/master/TCMS%20-%20Demo%20Corp%20-%20Findings%20Report%20-%20Example%202.docx


## Common Pentest Findings

#### Insufficient Authentication Controls - Example
1. MFA Bypassing

#### Weak Password Policy
1. Not great complexity
2. Expiration and history passwords
3. Credential stuffing

#### Insufficient Patching
1. Exploit DB have different CVE for different outdated versions of technologies. 

#### Default Credentials
1. Check default credentials and try before other methods. 

#### Insufficient Encryption
1. Http websites
2. Weak ciphers

#### Information  Disclosure
1. Sensitive information disclosure
2. Verbose Error messages 

#### Username Enumeration
1. Reset password with fake username, that will confirms if that exists or not. 


#### Default Webpages
1. Apache page
2. IIS page

#### Open Mail Relays
[https://www.blackhillsinfosec.com/how-to-test-for-open-mail-relays/](https://www.blackhillsinfosec.com/how-to-test-for-open-mail-relays/)

#### IKE Aggressive Mode
1. Internet Key Exchange Aggressive Mode with Pre-Shared Key


#### Unexpected Perimeter Services
1. RDP

#### Insufficient Traffic Blocking
1. Geographical Blocking

#### Undetected Malicious Activity
1. Activities occur after primary controls fail

#### Historical Account Compromises
1. No password renewal policy



## Wrapping Up 
#### Client Debriefs
1. Make it simple and high level explanation. 

#### Attestation Letters
1. Use template to save time. 

#### Client Retests 
1. Double check findings once vulnerabilities are mitigated. 


